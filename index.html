<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tost Chat â€” Midnight Edition</title>
<style>
:root{
  --bg-1:#0b0610;--bg-2:#0f0916;--accent-start:#6b2aa3;--accent-end:#2f1b4d;
  --text:#e8e6ee;--muted:#a79fb0;--bubble-me:linear-gradient(135deg,#7b3fb3aa,#5a2f8aaa);
  --bubble-other:rgba(255,255,255,0.05);
}
html,body{margin:0;height:100%;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));
font-family:Inter,ui-sans-serif,system-ui;color:var(--text);}
.app{display:flex;align-items:center;justify-content:center;height:100%;}

/* AUTH SCREEN */
.auth-screen{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  background:rgba(255,255,255,0.03);backdrop-filter:blur(10px);
  border-radius:16px;padding:30px;box-shadow:0 8px 32px rgba(0,0,0,0.6);
  max-width:360px;width:90%;text-align:center;gap:16px;
}
.auth-screen input{
  width:100%;padding:12px;border-radius:10px;border:none;background:rgba(255,255,255,0.05);
  color:var(--text);outline:none;text-align:center;font-size:15px;
}
.auth-screen button{
  width:100%;padding:12px;border:none;border-radius:10px;
  background:linear-gradient(90deg,var(--accent-start),var(--accent-end));
  color:white;font-weight:600;cursor:pointer;
}
.auth-screen h1{margin:0;font-size:20px;}
.auth-screen p{font-size:13px;color:var(--muted);}

/* CHAT */
.chat-container{display:none;flex-direction:column;width:100%;height:100vh;max-width:900px;margin:auto;padding:16px;box-sizing:border-box;}
.topbar{display:flex;align-items:center;gap:10px;margin-bottom:12px;}
.avatar{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#8b3fb8,#4c2a74);
display:flex;align-items:center;justify-content:center;font-weight:700;}
.messages{flex:1;overflow:auto;display:flex;flex-direction:column;gap:10px;padding:10px;background:rgba(255,255,255,0.02);border-radius:12px;}
.msg-row{display:flex;gap:10px;}
.msg-row.me{justify-content:flex-end;}
.bubble{padding:10px 12px;border-radius:10px;max-width:70%;font-size:14px;}
.bubble.me{background:var(--bubble-me);color:white;}
.bubble.other{background:var(--bubble-other);color:var(--text);}
.input-area{display:flex;gap:10px;margin-top:10px;}
.input-area textarea{flex:1;resize:none;border:none;border-radius:10px;padding:10px;background:rgba(255,255,255,0.05);color:var(--text);}
.input-area button{padding:10px 16px;border:none;border-radius:10px;background:linear-gradient(90deg,var(--accent-start),var(--accent-end));color:white;cursor:pointer;}
</style>
</head>
<body>

<div class="app">

  <!-- AUTH SCREEN -->
  <div class="auth-screen" id="authScreen">
    <h1>ðŸ”’ Sohbete GiriÅŸ</h1>
    <p>Devam etmek iÃ§in doÄŸrulama kelimesini gir</p>
    <input id="authInput" placeholder="DoÄŸrulama kelimesi" autocomplete="off"/>
    <button id="authBtn">GiriÅŸ</button>
    <p class="muted">Ä°pucu: kelime <b>8btost</b></p>
  </div>

  <!-- CHAT -->
  <div class="chat-container" id="chatContainer">
    <div class="topbar">
      <div class="avatar" id="topAvatar">T</div>
      <div>
        <div id="topName">Tost Chat</div>
        <div style="font-size:12px;color:var(--muted)">Midnight Edition</div>
      </div>
    </div>

    <div class="messages" id="messages"></div>

    <div class="input-area">
      <textarea id="msgInput" placeholder="Mesaj yaz... (Enter = gÃ¶nder)"></textarea>
      <button id="sendBtn">GÃ¶nder</button>
    </div>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const SECRET = "8btost";
const authInput = document.getElementById('authInput');
const authBtn = document.getElementById('authBtn');
const authScreen = document.getElementById('authScreen');
const chatContainer = document.getElementById('chatContainer');
const msgInput = document.getElementById('msgInput');
const sendBtn = document.getElementById('sendBtn');
const messagesEl = document.getElementById('messages');
const USERNAME = "User" + Math.floor(Math.random()*999);

function avatarLetter(name){return name.charAt(0).toUpperCase();}

authBtn.addEventListener('click',()=>{
  if(authInput.value.trim()===SECRET){
    authScreen.style.display='none';
    chatContainer.style.display='flex';
    initChat();
  }else{
    alert("YanlÄ±ÅŸ doÄŸrulama kelimesi!");
  }
});

authInput.addEventListener('keydown',e=>{
  if(e.key==="Enter") authBtn.click();
});

function initChat(){
  const firebaseConfig={
    apiKey:"AIzaSyDag_mCdG-tvvbZ3Dz7bpj9pbjh5teskg8",
    authDomain:"tost-269b0.firebaseapp.com",
    databaseURL:"https://tost-269b0-default-rtdb.firebaseio.com",
    projectId:"tost-269b0",
    storageBucket:"tost-269b0.firebasestorage.app",
    messagingSenderId:"882411853999",
    appId:"1:882411853999:web:8a0eb7a9b12d3df6b2dc5a",
  };
  const app=initializeApp(firebaseConfig);
  const db=getDatabase(app);
  const messagesRef=ref(db,"messages");

  onChildAdded(messagesRef,snap=>{
    const data=snap.val();
    addMsg(data);
  });

  sendBtn.addEventListener('click',()=>{
    const txt=msgInput.value.trim();
    if(!txt)return;
    push(messagesRef,{name:USERNAME,text:txt,time:Date.now()});
    msgInput.value='';
  });
  msgInput.addEventListener('keydown',e=>{
    if(e.key==="Enter"&&!e.shiftKey){e.preventDefault();sendBtn.click();}
  });
}

function addMsg(data){
  const row=document.createElement('div');
  row.className='msg-row'+(data.name===USERNAME?' me':'');
  const bubble=document.createElement('div');
  bubble.className='bubble '+(data.name===USERNAME?'me':'other');
  bubble.textContent=data.text;
  row.appendChild(bubble);
  messagesEl.appendChild(row);
  messagesEl.scrollTop=messagesEl.scrollHeight;
}
</script>

</body>
</html>